<!-- TEMPLATE FORM -->

<div class="form-container">
    <h2>Add New Product</h2>

    <div class="alert error" *ngIf="errorMsg">{{ errorMsg }}</div>
    <div class="alert success" *ngIf="successMsg">{{ successMsg }}</div>

    <!-- SELEKTOR ZA NGFORM i formRef-->
    <form #formRef="ngForm" (ngSubmit)="onSubmit()">
        <label>Product Name *</label>
        <input type=" text" [(ngModel)]="productName" name="productName" required /> <!-- MORA DA POSTOJI NAME -->

        <label>Description</label>
        <textarea [(ngModel)]="description" name="description" rows="3"></textarea>

        <label>Condition *</label>
        <select [(ngModel)]="condition" name="condition" required> <!-- VALIDACIJA -->
            <option value="" disabled>Select condition...</option>
            <option *ngFor="let c of conditions" [value]="c.value">{{ c.label }}</option>
        </select>

        <label>Price (RSD) *</label>
        <div class="price-field">
            <input type="number" [(ngModel)]="price" name="price" min="0" placeholder="2500" required />
            <span class="suffix">RSD</span>
        </div>

        <label>For (Age/Sex) *</label>
        <select [(ngModel)]="selectedAgeSexId" name="ageSex" (change)="onAgeSexChange()" required>
            <option [ngValue]="null" disabled selected>Select Age/Sex...</option>
            <option *ngFor="let a of ageSexList" [ngValue]="a.idAgeSex">{{ a.ageSexGroup }}</option>
        </select>

        <label>Category *</label>
        <select [(ngModel)]="selectedCategoryId" name="category" [disabled]="!selectedAgeSexId || loadingCategories"
            required>
            <option [ngValue]="null" disabled selected>Select category...</option>
            <option *ngFor="let c of categoriesForSelected" [ngValue]="c.idCategory">{{ c.categoryName }}</option>
        </select>

        <!-- slike -->
        <label>Product Images *</label>
        <input type="file" (change)="onFileSelected($event)" multiple accept="image/*" />
        <div class="preview-container" *ngIf="selectedFiles.length > 0">
            <div *ngFor="let file of selectedFiles" class="preview-item">
                <img [src]="file ? (file | filePreview) : ''" alt="Preview"
                    style="width: 80px; height: 80px; object-fit: cover; border: 1px solid #ccc;" />
                <p>{{ file.name }}</p>
            </div>
        </div>

        <button type="submit" [disabled]="submitting">Add Product</button>

        <div class="form-status valid" *ngIf="formRef.valid">
            ✅ Form is filled properly!
        </div>

        <div class="form-status invalid" *ngIf="formRef.invalid">
            ❌ Form is not filled properly. Please check required fields (*).
        </div>
    </form>
</div>